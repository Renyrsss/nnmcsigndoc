import {
  useConfig
} from "./chunk-QV2VTOJQ.js";
import {
  getTrad,
  pageSizes,
  pluginId,
  sortOptions
} from "./chunk-MBSH6UWY.js";
import "./chunk-PSSNSELH.js";
import "./chunk-RKO4BOCR.js";
import "./chunk-WRZDWTGU.js";
import "./chunk-FT3L2DHK.js";
import "./chunk-IN6ZLDGY.js";
import "./chunk-WUCZOGOZ.js";
import "./chunk-PMOAE3MM.js";
import "./chunk-VCI4ZHLQ.js";
import "./chunk-QIJGNK42.js";
import "./chunk-QCSUIBLX.js";
import "./chunk-ESSRQHZI.js";
import "./chunk-DEPSTSDQ.js";
import "./chunk-A5Q57TAH.js";
import "./chunk-463JLXR4.js";
import "./chunk-ZNMIZZ5L.js";
import "./chunk-I4ZJ4H3D.js";
import "./chunk-EODUY5KM.js";
import "./chunk-S7NGXQB4.js";
import "./chunk-2GAA65BV.js";
import "./chunk-KCH2J2JH.js";
import "./chunk-STPCI2VC.js";
import "./chunk-T6L3H7W5.js";
import "./chunk-WLESZBNU.js";
import {
  ConfirmDialog
} from "./chunk-OIRXFBXM.js";
import "./chunk-GSS3VPOL.js";
import "./chunk-QKOM4BQW.js";
import "./chunk-3TP4NRZF.js";
import "./chunk-MBK4V2X7.js";
import "./chunk-D4WYVNVM.js";
import "./chunk-MMOBCIZG.js";
import {
  require_set
} from "./chunk-3DXODPN2.js";
import "./chunk-GOCXJSG5.js";
import "./chunk-T2ARN7TZ.js";
import "./chunk-F2U3ELYS.js";
import "./chunk-3MFJCHUS.js";
import "./chunk-5KSKASNQ.js";
import "./chunk-EYKV5VT6.js";
import "./chunk-IFOFBKTA.js";
import "./chunk-FVCM5UXG.js";
import "./chunk-U2S4VNVE.js";
import "./chunk-4FX2ZSS4.js";
import {
  Layouts
} from "./chunk-AFKKV4AI.js";
import {
  useTracking
} from "./chunk-QGTVHIRS.js";
import "./chunk-AAYRDTCB.js";
import "./chunk-3GJUYW3U.js";
import "./chunk-PQINNV4N.js";
import {
  require_isEqual
} from "./chunk-FPU5PDM4.js";
import {
  Page
} from "./chunk-DCAZPVRX.js";
import "./chunk-BRC7J3UG.js";
import "./chunk-FFHFTD5C.js";
import {
  useNotification
} from "./chunk-UEV6VIK2.js";
import {
  require_get,
  require_lib
} from "./chunk-Y43T2BU2.js";
import "./chunk-4KCSPRST.js";
import "./chunk-V3H6CYGR.js";
import "./chunk-ZC6UOKQ5.js";
import "./chunk-HM5YIFDI.js";
import {
  fn
} from "./chunk-QOUV5O5E.js";
import {
  Box,
  Button,
  Dialog,
  Field,
  Grid,
  Link,
  SingleSelect,
  SingleSelectOption,
  useIntl
} from "./chunk-NSJ43L5S.js";
import "./chunk-7K6WC7UG.js";
import {
  NavLink
} from "./chunk-RKN75MQZ.js";
import "./chunk-AWHRF5BE.js";
import {
  ForwardRef$2J,
  ForwardRef$2o
} from "./chunk-EXVE46AP.js";
import {
  require_jsx_runtime
} from "./chunk-LMPM4PM5.js";
import "./chunk-3LBZKDTB.js";
import {
  require_react
} from "./chunk-D3I3COXH.js";
import {
  __toESM
} from "./chunk-LK32TJAX.js";

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/ConfigureTheView.mjs
var import_jsx_runtime2 = __toESM(require_jsx_runtime(), 1);
var React = __toESM(require_react(), 1);
var import_isEqual = __toESM(require_isEqual(), 1);
var import_qs2 = __toESM(require_lib(), 1);

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/components/Settings.mjs
var import_jsx_runtime = __toESM(require_jsx_runtime(), 1);
var import_qs = __toESM(require_lib(), 1);
var Settings = ({ sort = "", pageSize = 10, onChange: onChange2 }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime.jsx)(Box, {
    background: "neutral0",
    hasRadius: true,
    shadow: "tableShadow",
    paddingTop: 6,
    paddingBottom: 6,
    paddingLeft: 7,
    paddingRight: 7,
    children: (0, import_jsx_runtime.jsxs)(Grid.Root, {
      gap: 4,
      children: [
        (0, import_jsx_runtime.jsx)(Grid.Item, {
          s: 12,
          col: 6,
          direction: "column",
          alignItems: "stretch",
          children: (0, import_jsx_runtime.jsxs)(Field.Root, {
            hint: formatMessage({
              id: getTrad("config.entries.note"),
              defaultMessage: "Number of assets displayed by default in the Media Library"
            }),
            name: "pageSize",
            children: [
              (0, import_jsx_runtime.jsx)(Field.Label, {
                children: formatMessage({
                  id: getTrad("config.entries.title"),
                  defaultMessage: "Entries per page"
                })
              }),
              (0, import_jsx_runtime.jsx)(SingleSelect, {
                onChange: (value) => onChange2({
                  target: {
                    name: "pageSize",
                    value
                  }
                }),
                value: pageSize,
                children: pageSizes.map((pageSize2) => (0, import_jsx_runtime.jsx)(SingleSelectOption, {
                  value: pageSize2,
                  children: pageSize2
                }, pageSize2))
              }),
              (0, import_jsx_runtime.jsx)(Field.Hint, {})
            ]
          })
        }),
        (0, import_jsx_runtime.jsx)(Grid.Item, {
          s: 12,
          col: 6,
          direction: "column",
          alignItems: "stretch",
          children: (0, import_jsx_runtime.jsxs)(Field.Root, {
            hint: formatMessage({
              id: getTrad("config.note"),
              defaultMessage: "Note: You can override this value in the media library."
            }),
            name: "sort",
            children: [
              (0, import_jsx_runtime.jsx)(Field.Label, {
                children: formatMessage({
                  id: getTrad("config.sort.title"),
                  defaultMessage: "Default sort order"
                })
              }),
              (0, import_jsx_runtime.jsx)(SingleSelect, {
                onChange: (value) => onChange2({
                  target: {
                    name: "sort",
                    value
                  }
                }),
                value: sort,
                "test-sort": sort,
                "data-testid": "sort-select",
                children: sortOptions.map((filter) => (0, import_jsx_runtime.jsx)(SingleSelectOption, {
                  "data-testid": `sort-option-${filter.value}`,
                  value: filter.value,
                  children: formatMessage({
                    id: getTrad(filter.key),
                    defaultMessage: `${filter.value}`
                  })
                }, filter.key))
              }),
              (0, import_jsx_runtime.jsx)(Field.Hint, {})
            ]
          })
        })
      ]
    })
  });
};

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/actionTypes.mjs
var ON_CHANGE = `${pluginId}/ON_CHANGE`;
var SET_LOADED = `${pluginId}/SET_LOADED`;

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/actions.mjs
var onChange = ({ name, value }) => ({
  type: ON_CHANGE,
  keys: name,
  value
});
var setLoaded = () => ({
  type: SET_LOADED
});

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/init.mjs
var initialState = {
  initialData: {},
  modifiedData: {}
};
var init = (configData) => {
  return {
    ...initialState,
    initialData: configData,
    modifiedData: configData
  };
};

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/state/reducer.mjs
var import_get = __toESM(require_get(), 1);
var import_set = __toESM(require_set(), 1);
var reducer = (state = initialState, action = {
  type: ""
}) => (
  // eslint-disable-next-line consistent-return
  fn(state, (draftState) => {
    switch (action.type) {
      case ON_CHANGE: {
        if ("keys" in action && "value" in action && action.keys) {
          (0, import_set.default)(draftState, [
            "modifiedData",
            ...action.keys.split(".")
          ], action.value);
        }
        break;
      }
      case SET_LOADED: {
        const reInitialise = init((0, import_get.default)(draftState, [
          "modifiedData"
        ], {}));
        draftState.initialData = reInitialise.initialData;
        draftState.modifiedData = reInitialise.modifiedData;
        break;
      }
      default:
        return draftState;
    }
  })
);

// node_modules/@strapi/upload/dist/admin/pages/App/ConfigureTheView/ConfigureTheView.mjs
var ConfigureTheView = ({ config }) => {
  const { trackUsage } = useTracking();
  const { formatMessage } = useIntl();
  const { toggleNotification } = useNotification();
  const { mutateConfig } = useConfig();
  const { isLoading: isSubmittingForm } = mutateConfig;
  const [showWarningSubmit, setWarningSubmit] = React.useState(false);
  const toggleWarningSubmit = () => setWarningSubmit((prevState) => !prevState);
  const [reducerState, dispatch] = React.useReducer(reducer, initialState, () => init(config));
  const typedDispatch = dispatch;
  const { initialData, modifiedData } = reducerState;
  const handleSubmit = (e) => {
    e.preventDefault();
    toggleWarningSubmit();
  };
  const handleConfirm = async () => {
    trackUsage("willEditMediaLibraryConfig");
    await mutateConfig.mutateAsync(modifiedData);
    setWarningSubmit(false);
    typedDispatch(setLoaded());
    toggleNotification({
      type: "success",
      message: formatMessage({
        id: "notification.form.success.fields",
        defaultMessage: "Changes saved"
      })
    });
  };
  const handleChange = ({ target: { name, value } }) => {
    typedDispatch(onChange({
      name,
      value
    }));
  };
  return (0, import_jsx_runtime2.jsx)(Layouts.Root, {
    children: (0, import_jsx_runtime2.jsx)(Page.Main, {
      "aria-busy": isSubmittingForm,
      children: (0, import_jsx_runtime2.jsxs)("form", {
        onSubmit: handleSubmit,
        children: [
          (0, import_jsx_runtime2.jsx)(Layouts.Header, {
            navigationAction: (0, import_jsx_runtime2.jsx)(Link, {
              tag: NavLink,
              startIcon: (0, import_jsx_runtime2.jsx)(ForwardRef$2J, {}),
              to: `/plugins/${pluginId}`,
              id: "go-back",
              children: formatMessage({
                id: getTrad("config.back"),
                defaultMessage: "Back"
              })
            }),
            primaryAction: (0, import_jsx_runtime2.jsx)(Button, {
              size: "S",
              startIcon: (0, import_jsx_runtime2.jsx)(ForwardRef$2o, {}),
              disabled: (0, import_isEqual.default)(modifiedData, initialData),
              type: "submit",
              children: formatMessage({
                id: "global.save",
                defaultMessage: "Save"
              })
            }),
            subtitle: formatMessage({
              id: getTrad("config.subtitle"),
              defaultMessage: "Define the view settings of the media library."
            }),
            title: formatMessage({
              id: getTrad("config.title"),
              defaultMessage: "Configure the view - Media Library"
            })
          }),
          (0, import_jsx_runtime2.jsx)(Layouts.Content, {
            children: (0, import_jsx_runtime2.jsx)(Settings, {
              "data-testid": "settings",
              pageSize: modifiedData.pageSize || "",
              sort: modifiedData.sort || "",
              onChange: handleChange
            })
          }),
          "x",
          (0, import_jsx_runtime2.jsx)(Dialog.Root, {
            open: showWarningSubmit,
            onOpenChange: toggleWarningSubmit,
            children: (0, import_jsx_runtime2.jsx)(ConfirmDialog, {
              onConfirm: handleConfirm,
              variant: "default",
              children: formatMessage({
                id: getTrad("config.popUpWarning.warning.updateAllSettings"),
                defaultMessage: "This will modify all your settings"
              })
            })
          })
        ]
      })
    })
  });
};
export {
  ConfigureTheView
};
//# sourceMappingURL=ConfigureTheView-M7WCIW4P.js.map
